function showmymap(){var e=document.getElementById("myinput"),t={lat:37.3382082,lng:-121.88632860000001},o={center:t,zoom:15,scrollwheel:!1}
map=new google.maps.Map(mapdiv,o),autocomplete=new google.maps.places.Autocomplete(e,{types:["(cities)"]}),autocomplete.addListener("place_changed",_navigate)}function _navigate(){_moveto={lat:autocomplete.getPlace().geometry.location.lat(),lng:autocomplete.getPlace().geometry.location.lng()},mybutton.onclick=function(){return $("html, body").animate({scrollTop:$("#map-canvas").offset().top},2e3),markers.forEach(function(e){e.setMap(null)}),markers=[],""===_lookingfor.value.trim()?void alert("What are you looking for ?"):(console.log("looking for "+_lookingfor.value.trim()+" in the co-ordinates "+_moveto.lat+","+_moveto.lng),void initialize(_moveto,_lookingfor.value.trim()))}}function initialize(e,t){map.setCenter(e),infowindow=new google.maps.InfoWindow
var o=new google.maps.places.PlacesService(map)
o.textSearch({location:e,radius:500,query:t,zoom:15,scrollwheel:!1},callback)}function callback(e,t){if(t===google.maps.places.PlacesServiceStatus.OK){document.getElementById("carcontent").innerHTML=""
var o=[]
_totalpointers=e.length
for(var a=0;a<e.length;a++)add_to_carousel(a,e[a]),createMarker(a,e[a]),console.log("Index of "+e[a].name+" is "+a),"undefined"!=typeof e[a].rating&&e[a].rating>=0?o[a]=[e[a].name,e[a].rating]:o[a]=[e[a].name,0]
o.forEach(function(e){0===e[1]&&o.splice(o.indexOf(e),1)}),aggregate(o)}}function createMarker(e,t){var o=(t.geometry.location,new google.maps.Marker({name:t.name,map:map,position:t.geometry.location,animation:google.maps.Animation.DROP,locindex:e,icon:"/pages/img/zicon.png"}))
0===e&&o.setAnimation(google.maps.Animation.BOUNCE),markers[e]=o
var a="number"==typeof t.rating?t.rating:0,n="number"==typeof t.minPriceLevel?t.minPriceLevel:0
drawcharts(a,n,e),google.maps.event.addListener(o,"click",function(){infowindow.setContent(t.name),infowindow.open(map,this),markers.forEach(function(e){e.setAnimation(null)}),this.setAnimation(google.maps.Animation.BOUNCE),$(".carousel").carousel(o.locindex)})}function add_to_carousel(e,t){var o="undefined"==typeof t.formatted_phone_number?"(N/A)":t.formatted_phone_number
0===e?holderchild="<div class='item active' style='width:100%;'><table><tr> <td colspan='3'> <h4>"+t.name.toUpperCase()+"</h4></td></tr><tr><td><img class='logos' src='"+t.icon+"'></td><td colspan='2'><div id='pic"+e+"'></div></td></tr><tr> <td><span class='fa fa-map-marker fa-2x'></span></td><td colspan='2'> <h5>"+t.formatted_address+"</h5></td></tr><tr> <td><span class='fa fa-phone-square fa-2x'></span></td><td colspan='2'> <h5>"+o+"</h5></td></tr></table></div>":holderchild="<div class='item'><table class=style='width:100%; '><tr> <td colspan='3'> <h4>"+t.name.toUpperCase()+"</h4></td></tr><tr><td><img class='logos' src='"+t.icon+"'></td><td colspan='2'><div id='pic"+e+"'></div></td></tr><tr> <td><span class='fa fa-map-marker fa-2x'></span></td><td colspan='2'> <h5>"+t.formatted_address+"</h5></td></tr><tr> <td><span class='fa fa-phone-square fa-2x'></span></td><td colspan='2'> <h5>"+o+"</h5></td></tr></table></div>",$("#carcontent").append(holderchild)}var mybutton=document.getElementById("giveme"),mapdiv=document.getElementById("map-canvas"),_lookingfor=document.getElementById("lookinput"),_moveto,check=0,markers=[],infowindow,_totalpointers
$("#myCarousel").bind("slide.bs.carousel",function(e){setTimeout(function(){currentIndex=$("div.active").index(),console.log(currentIndex+" is the index of the slide now."),markers.forEach(function(e){e.animating&&(e.setAnimation(null),infowindow.close(map,this))}),markers[currentIndex].setAnimation(google.maps.Animation.BOUNCE)},1e3)})
