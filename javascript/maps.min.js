function showmymap(){var e=document.getElementById("myinput"),t={lat:37.3382082,lng:-121.88632860000001},o={center:t,zoom:15,scrollwheel:!1}
map=new google.maps.Map(mapdiv,o),autocomplete=new google.maps.places.Autocomplete(e,{types:["(cities)"]}),autocomplete.addListener("place_changed",_navigate)}function _navigate(){_moveto={lat:autocomplete.getPlace().geometry.location.lat(),lng:autocomplete.getPlace().geometry.location.lng()},mybutton.onclick=function(){return markers.forEach(function(e){e.setMap(null)}),markers=[],""===_lookingfor.value.trim()?void alert("Oops! Looks like you haven't keyed in the place/Location you are searching for/in"):(console.log("looking for "+_lookingfor.value.trim()+" in the co-ordinates "+_moveto.lat+","+_moveto.lng),void initialize(_moveto,_lookingfor.value.trim()))}}function initialize(e,t){map.setCenter(e),infowindow=new google.maps.InfoWindow
var o=new google.maps.places.PlacesService(map)
o.textSearch({location:e,radius:500,query:t,zoom:15,scrollwheel:!1},callback)}function callback(e,t){if($("html, body").animate({scrollTop:$("#map-canvas").offset().top},2e3),t===google.maps.places.PlacesServiceStatus.OK){document.getElementById("carcontent").innerHTML=""
var o=[]
_totalpointers=e.length
for(var a=0;a<e.length;a++)add_to_carousel(a,e[a]),createMarker(a,e[a]),console.log("Index of "+e[a].name+" is "+a),"undefined"!=typeof e[a].rating&&e[a].rating>=0?o[a]=[e[a].name,e[a].rating]:o[a]=[e[a].name,0]
o.forEach(function(e){0===e[1]&&o.splice(o.indexOf(e),1)}),aggregate(o)}}function createMarker(e,t){var o=(t.geometry.location,new google.maps.Marker({name:t.name,map:map,position:t.geometry.location,animation:google.maps.Animation.DROP,locindex:e,icon:"/pages/img/zicon.png"}))
0===e&&o.setAnimation(google.maps.Animation.BOUNCE),markers[e]=o
var a="number"==typeof t.rating?t.rating:0,n="number"==typeof t.minPriceLevel?t.minPriceLevel:0
drawcharts(a,n,e),google.maps.event.addListener(o,"click",function(){infowindow.setContent(t.name),infowindow.open(map,this),markers.forEach(function(e){e.setAnimation(null)}),this.setAnimation(google.maps.Animation.BOUNCE),$(".carousel").carousel(o.locindex)})}function add_to_carousel(e,t){var o="undefined"==typeof t.formatted_phone_number?"(N/A)":t.formatted_phone_number,a=t.types,n=" "
a.forEach(function(e){n+="<li>"+e.toUpperCase()+"</li>"})
var i="undefined"!=typeof t.rating?t.rating:"Not Available",l="undefined"==typeof t.min_price_level?"Not Available":t.min_price_level
0===e?holderchild="<div class='item active' style='width:100%;'><table><tr> <td colspan='3'> <h2>"+t.name.toUpperCase()+"</h2></td></tr><tr><td class='logos'><img src='"+t.icon+"'> <div>"+n+" </div></td><td colspan='2'><div class='picd' id='pic"+e+"'></div><div class='picm'><li> <h3>Rated : "+i+"</h3></li><li> <h3> Min. Price: "+l+" </h3></li></div></td></tr><tr> <td><span class='fa fa-map-marker fa-2x'></span></td><td colspan='2'> <h3>"+t.formatted_address+"</h3></td></tr><tr> <td><span class='fa fa-phone-square fa-2x'></span></td><td colspan='2'> <h3>"+o+"</h3></td></tr></table></div>":holderchild="<div class='item' style='width:100%;'><table><tr> <td colspan='3'> <h2>"+t.name.toUpperCase()+"</h2></td></tr><tr><td class='logos'><img src='"+t.icon+"'> <div>"+n+" </div></td><td colspan='2'><div class='picd' id='pic"+e+"'></div><div class='picm'><li> <h3>Rated : "+i+"</h3></li><li> <h3> Min. Price: "+l+" </h3></li></div></td></tr><tr> <td><span class='fa fa-map-marker fa-2x'></span></td><td colspan='2'> <h3>"+t.formatted_address+"</h3></td></tr><tr> <td><span class='fa fa-phone-square fa-2x'></span></td><td colspan='2'> <h3>"+o+"</h3></td></tr></table></div>",$("#carcontent").append(holderchild)}var mybutton=document.getElementById("giveme"),mapdiv=document.getElementById("map-canvas"),_lookingfor=document.getElementById("lookinput"),_moveto,check=0,markers=[],infowindow,_totalpointers
$("#myCarousel").bind("slide.bs.carousel",function(e){setTimeout(function(){currentIndex=$("div.active").index(),console.log(currentIndex+" is the index of the slide now."),markers.forEach(function(e){e.animating&&(e.setAnimation(null),infowindow.close(map,this))}),markers[currentIndex].setAnimation(google.maps.Animation.BOUNCE)},1e3)})
